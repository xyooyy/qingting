(function(k){k.action=function(){return{role:function(){var i=function(e,d,f,g,j){if(j.length>0){e=[];for(f=0;f<j.length;f++){g=[];d=j[f].frames;for(var h=0;h<d.length;h++)g.push({args:[d[h][0],d[h][1],d[h][2]],step:d[h][3]});e.push(new k.action.sprite(g,j[f].loop,0,0))}}return e};return function(e,d,f,g,j,h,n,o){this.imageNames=j||[];this.rects=h||[];this.frames=n||[];this.actions=o||[];this.sprites=i(e,this.imageNames,this.rects,this.frames,this.actions)||[];this.x=d||0;this.y=f||0;this.current=
g||0;this.zoom=1;this.setSprite=function(a){this.current=a>=this.sprites.length?this.sprites.length-1:a>0?a:0;this.sprites[this.current].setFrame(0);return this};this.getSprite=function(){return this.sprites[this.current]};this.getFrame=function(){return this.frames[this.getSprite().getFrame().args[0]]};this.action=function(){this.x+=this.getSprite().getFrame().args[1];this.y+=this.getSprite().getFrame().args[2]};this.render=function(a,l){if(!a){this.x+=this.getSprite().getFrame().args[1];this.y+=
this.getSprite().getFrame().args[2]}for(var c=this.frames[this.getSprite().getFrame().args[0]].frameArray,p=c.length,q=l?l:k.canvas,m,b=0;b<p;b++){m=l?k.getImage(this.imageNames[c[b][0]]):this.imageNames[c[b][0]];q.drawImage(m,this.rects[c[b][0]][c[b][1]][0],this.rects[c[b][0]][c[b][1]][1],this.rects[c[b][0]][c[b][1]][2],this.rects[c[b][0]][c[b][1]][3],this.x+c[b][2]*this.zoom,this.y+c[b][3]*this.zoom,this.rects[c[b][0]][c[b][1]][2]*this.zoom,this.rects[c[b][0]][c[b][1]][3]*this.zoom)}};this.setZoom=
function(a){if(a>0)this.zoom=a};this.getBodyRect=function(){var a=this.getFrame().bodyRect;return this.zoom==1?a:[a[0]*this.zoom,a[1]*this.zoom,a[2]*this.zoom,a[3]*this.zoom]};this.getAttackRect=function(){var a=this.getFrame().actRect;return this.zoom==1?a:[a[0]*this.zoom,a[1]*this.zoom,a[2]*this.zoom,a[3]*this.zoom]}}}(),sprite:function(){return function(i,e,d,f){this.frames=i||[];this.loop=e;this.current=d||0;this.step=f||0;this.setFrame=function(g){this.current=g>=this.frames.length?this.frames.length-
1:g>0?g:0;if(this.getFrame().step)this.runStep=this.getFrame().step;return this};this.getFrame=function(){return this.frames[this.current]};this.nextFrame=function(){if(this.frames.length>0)if(this.runStep<=0){if(this.loop){this.current++;this.current%=this.frames.length}else this.current<this.frames.length-1&&this.current++;this.runStep=this.getFrame().step?this.getFrame().step:this.step}else this.runStep--;return this};this.preFrame=function(){if(this.frames.length>0)if(this.runStep<=0){if(this.loop){this.current--;
if(this.current<0)this.current=this.frames.length-1}else this.current>0&&this.current--;this.runStep=this.getFrame().step?this.getFrame().step:this.step}else this.runStep--;return this};this.endFrame=function(){return this.current==this.frames.length-1&&this.runStep==0};this.setFrame(d);this.runStep=this.getFrame().step?this.getFrame().step:this.step}}(),fragment:function(){var i;return function(e){this.sprites=e||[];this.queue=function(){if(this.sprites.length>0){if(this.sprites[0].frames.length>
0)if(this.sprites[0].runStep<=0){this.sprites[0].runStep=this.sprites[0].step;i=this.sprites[0].frames.shift();this.sprites[0].frames.length==0&&this.sprites.shift()}else{i=this.sprites[0].getFrame();this.sprites[0].runStep--}}else i=null;return i}}}()}}()})(jsGame);
